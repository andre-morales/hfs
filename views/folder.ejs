<!DOCTYPE html>
<html lang="en-us">
<head>
	<%- include('head.ejs'); %>
	<title>HFS - Andr√©</title>
	<link rel="stylesheet" href="/res/css/folder_style.css" type="text/css">
	<script>
		var folder = '<%- folder %>';
		function main(){}
		function openContextMenu(){}
	</script>
	<script src="/res/js/folder_script.js"></script>
</head>

<body onload="main();">
	<table id="path-toolbar" cellspacing="0" style="width: 100%;">
		<tbody>
			<tr>
				<td><a href="../"><img src="/res/back.gif"/></a></td>
				<td style="width: 100%;">
					<h1 id="folder-path">
						<%
							var sp = folder.split('/');
							for(var i = 0; i < sp.length - 1; i++){
								echo("<a href='" + sp.slice(0, i + 1).join("/") + "/'>" + sp[i] + "/</a>");
							}
						%>
					</h1>
				</td>
				<td><a href="."><img src="/res/reload.gif"/></a></td>
			</tr>
		</tbody>
	</table>
	<hr/>
	<p id="warning-message">You either disabled javascript or your browser is too old to support it properly. Some functionality on this page will only work on IE5+ with JS enabled.</p>
	<form enctype="multipart/form-data" method="post" style="display: inline; border: solid 1px gray; padding: 4px;">
		<input type="file" name="file" style="height: 2em;"/>
		<input type="submit" name="fileSubmitForm" value="Upload" style="height: 2em;"/>
	</form>
	<hr/>
	<div id="files">
		<table cellspacing="0">
			<tbody>
			<%
				genFileTableEntries();
			%>
			</tbody>
		</table>
	</div>
	<div id="context-menu">
		<a id="cm-close" href="javascript:cm_close();">Close</a>
		<a id="cm-edit">Edit</a>
		<a id="cm-watch">Watch</a>
		<a href="javascript:;">Delete</a>
	</div>
	<%- include ('footer.ejs') %>
</body>
</html>

<%
function genFileTableEntries(){
	for (var i = 0; i < files.length; i++){
		var pathName = files[i];

		var color = (i % 2 == 1)?'color-1':'color-2';

		if(pathName.endsWith('/')){
			var folderName = pathName.slice(0, -1);
			var pathURIName = encodeURIComponent(folderName);
			genFileTableEntry(folderName, pathURIName + "/", 'folder', color);
		} else {
			var pathURIName = encodeURIComponent(pathName);
			genFileTableEntry(pathName, pathURIName, 'file', color);
		}
	}
}

function genFileTableEntry(name, path, icon, rowColor){
	%>
		<tr class="<%-rowColor-%>">
			<td class="menu-wrapper">
				<span data-path="<%-path%>">
					<button onclick="openContextMenu(this);">&nbsp;&gt;&nbsp;</button>
				</span>
			</td>
			<td class="FileImg">
				<a href="<%-path%>">
					<img src="/res/<%-icon%>.gif" width="32" height="32"/>
				</a>
			</td>
			<td class="FileLink">
				<a href="<%-path%>"><%-name%></a>
			</td>
		</tr>
	<%
}

function echo(s){ %><%-s%><% }
%>